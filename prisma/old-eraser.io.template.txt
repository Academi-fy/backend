Blackboard {
  id        String       pk
  createdAt DateTime
  updatedAt DateTime

  authors User[] fk
  coverImage String?
  school School fk
  state String
  tags BlackboardTag[] fk
  targets User[] fk
  text     String?
  title    String

}

BlackboardTag {
  id        String   pk
  createdAt DateTime
  updatedAt DateTime

  blackboards Blackboard[] fk
  name String

}

BlackboardBlackboardTag {
  id String pk
  blackboardId String fk
  tagId  String fk
}

BlackboardAuthor {
  id String pk
  authorId String fk
  blackboardId String fk
}

Blackboard.targets <> User.id

Blackboard.tags <> BlackboardBlackboardTag.blackboardId
BlackboardBlackboardTag.tagId <> BlackboardTag.blackboards

Blackboard.authors <> BlackboardAuthor.authorId
BlackboardAuthor.blackboardId <> User.blackboards

Chat {
  id        String       pk
  createdAt DateTime
  updatedAt DateTime

  avatar    String?
  clubs       Club[] fk
  courses     Course[] fk
  messages    Message[] fk
  name      String
  targets     UserChat[] fk
  type      String
}

ChatTarget {
  id String pk
  chatId String fk
  targetId String fk
}

Chat.targets <> ChatTarget.targetId
ChatTarget.chatId <> UserChat.chat

ChatCourse {
  id String pk
  chatId string fk
  courseId String fk
}

Chat.courses <> ChatCourse.courseId
ChatCourse.chatId - Course.chat

ChatClub {
  id String pk
  clubId String fk
  chatId string fk
}

Chat.clubs <> ChatClub.clubId
ChatClub.chatId - Club.chat

ChatMessage {
  id String pk
  chatId string fk
  messageId String fk
}

Chat.messages <> ChatMessage.messageId
ChatMessage.chatId - Message.chat

Class {
  id        String       pk
  createdAt DateTime
  updatedAt DateTime

  courses Course[] fk
  grade   Grade   fk
  members User[] fk
  school School[] fk
  specifiedGrade String?

}

ClassGrade {
  id String pk
  classId string fk
  gradeId String fk
}

Class.grade - ClassGrade.gradeId
ClassGrade.classId <> Grade.classes

Club {
  id        String       pk
  createdAt DateTime
  updatedAt DateTime

  chat   Chat   fk
  coverImage String?
  description String?
  events  Event[] fk
  leaders User[] fk
  location String?
  meetingDay String?
  meetingTime String?
  members User[] fk
  name      String
  requirements Json[]
  school School fk
  state String
  tags    ClubTag[] fk

}

ClubTag {
  id        String   pk
  createdAt DateTime
  updatedAt DateTime

  clubs Club[] fk
  name String

}

ClubLeader {
  id String pk
  clubId String fk
  leaderId String fk
}

Club.leaders <> ClubLeader.id

ClubMember {
  id String pk
  clubId String fk
  memberId String fk
}

Club.members <> ClubMember.memberId
ClubMember.clubId <> User.clubs

ClubEvent {
  id String pk
  clubId String fk
  eventId String fk
}

Club.events <> ClubEvent.eventId
ClubEvent.clubId <> Event.clubs

ClubClubTag {
  id String pk
  clubId String fk
  tagId String fk
}

Club.tags <> ClubClubTag.tagId
ClubClubTag.clubId <> ClubTag.clubs

Course {
  id        String       pk
  createdAt DateTime
  updatedAt DateTime

  chat   Chat fk
  classes Class[] fk
  members User[] fk
  subject    Subject fk
  teacher   User fk

}

CourseSubject {
  id String pk
  courseId String fk
  subjectId String fk
}

Course.subject - CourseSubject.subjectId
CourseSubject.courseId <> Subject.courses

CourseMember {
  id String pk
  courseId String fk
  memberId String fk
}

Course.members <> CourseMember.memberId
CourseMember.courseId <> User.courses

CourseClass {
  id String pk
  classId String fk
  courseId String fk
}

Course.classes <> CourseClass.classId
CourseClass.courseId <> Class.courses

Event {
  id        String       pk
  createdAt DateTime
  updatedAt DateTime

  clubs Club[] fk
  description String?
  endDate DateTime
  host String
  information Json[]
  location  String?
  school School fk
  startDate DateTime
  state String
  subscribers User[] fk
  tickets EventTicket[] fk
  title     String

}

EventClub {
  id String pk
  clubId String fk
  eventId String fk
}

Event.clubs <> EventClub.clubId
EventClub.eventId <> Club.events

EventEventTicket {
  id String pk
  eventId String fk
  eventTicketId String fk
}

Event.tickets <> EventEventTicket.eventTicketId
EventEventTicket.eventId - EventTicket.event

EventSubscriber {
  id String pk
  eventId String fk
  subscriberId String fk
}

Event.subscribers <> EventSubscriber.subscriberId
EventSubscriber.eventId <> User.events

EventTicket {
  id        String   pk
  createdAt DateTime
  updatedAt DateTime

  buyer     User     fk
  event     Event    fk
  price     Int
  saleDate  DateTime
}

EventTicketBuyer {
  id String pk
  buyerId String fk
  eventTicketId String fk
}

EventTicket.buyer - EventTicketBuyer.buyerId
EventTicketBuyer.eventTicketId <> User.eventTickets

Grade {
  id        String       pk
  createdAt DateTime
  updatedAt DateTime

  classes Class[]
  level Int
  school School fk
}

Message {
  id        String   pk
  createdAt DateTime
  updatedAt DateTime

  author   User   fk
  chat   Chat   fk
  content Json[]
  editHistory Json[]
  reactions Json[]
  replies Message[] fk
  replyTo   Message? fk
}

Message.author <> User.messages
Message.replyTo - Message.id

MessageReply {
  id String pk
  messageId String fk
  replyId String fk
}

Message.replies <> MessageReply.replyId
MessageReply.messageId - Message.id

School {
  id        String   pk
  createdAt DateTime
  updatedAt DateTime

  blackboards Blackboard[] fk
  classes   Class[] fk
  clubs     Club[] fk
  events    Event[] fk
  grades    Grade[] fk
  members   User[] fk
  name      String
  setupAccount SetupAccount fk
  subjects  Subject[] fk
}

SchoolGrade {
  id String pk
  gradeId String fk
  schoolId String fk
}

School.grades <> SchoolGrade.gradeId
SchoolGrade.schoolId - Grade.school

SchoolMember {
  id String pk
  memberId String fk
  schoolId String fk
}

School.members <> SchoolMember.memberId
SchoolMember.schoolId <> User.schools

SchoolClass {
  id String pk
  classId String fk
  schoolId String fk
}

School.classes <> SchoolClass.classId
SchoolClass.schoolId - Class.school

SchoolSubject {
  id String pk
  schoolId String fk
  subjectId String fk
}

School.subjects <> SchoolSubject.subjectId
SchoolSubject.schoolId - Subject.school

SchoolClub {
  id String pk
  clubId String fk
  schoolId String fk
}

School.clubs <> SchoolClub.clubId
SchoolClub.schoolId - Club.school

SchoolEvent {
  id String pk
  eventId String fk
  schoolId String fk
}

School.events <> SchoolEvent.eventId
SchoolEvent.schoolId - Event.school

SchoolBlackboard {
  id String pk
  blackboardId String fk
  schoolId String fk
}

School.blackboards <> SchoolBlackboard.blackboardId
SchoolBlackboard.schoolId - Blackboard.school

SetupAccount {
  id        String   pk
  createdAt DateTime
  updatedAt DateTime

  school   School   fk
  schoolName String
}

SetupAccountSchool {
  id String pk

  schoolId String fk
  setupAccountId String fk
}

SetupAccount.school - SetupAccountSchool.schoolId
SetupAccountSchool.setupAccountId - School.setupAccount

Subject {
  id        String   pk
  createdAt DateTime
  updatedAt DateTime

  courses Course[]
  school School
  shortName String
  type      String

}

User {
  id        String       pk
  createdAt DateTime
  updatedAt DateTime

  avatar    String?
  blackboards Blackboard[] fk
  clubs       Club[] fk
  courses     Course[] fk
  events      Event[] fk
  firstName String
  lastName  String
  messages    Message[] fk
  schools     School[] fk
  type      String
  userAccount UserAccount fk
  userChats UserChat[] fk
  eventTickets EventTicket[] fk

}

UserAccount {
  id        String   pk
  createdAt DateTime
  updatedAt DateTime

  password String
  user   User   fk
  username String @unique
}

UserUserAccount {
  id String pk
  userAccountId String fk
  userId String fk
}

User.userAccount - UserUserAccount.userAccountId
UserUserAccount.userId - UserAccount.user

UserChat {
  id        String   pk
  createdAt DateTime
  updatedAt DateTime

  chat   Chat   fk
  hidden Boolean @default(false)
  pinned Boolean @default(false)
  read Boolean @default(false)
  user   User  fk

}

UserChat.user < User.userChats
UserChat.chat - ChatTarget.chatId